## 1. Vulnerabilities

![[Pasted image 20240129094036.png]]
![[Pasted image 20240129094151.png]]
### CyberSecurity'i soygun olarak düşünebilirsin.

![[Pasted image 20240129094422.png]]
### 1. OSI modele göre 1nci katmanı soygundaki elektirik hatlarının kesilmesinin planı olarak düşünebilirsin.
![[Pasted image 20240129094618.png]]



![[Pasted image 20240129094713.png]]
![[Pasted image 20240129095027.png]]

## Common Vulnerabilities and Exposures

##### https://cve.mitre.org/
##### CVE'ler MITRE corpetation tarafından yönetilir ve yayınlanır.
![[Pasted image 20240129095321.png]]

### MITRE-CVE -->> National Cyber Security Division of US Department of Homeland Security tarafından fonlanır.


![[Pasted image 20240129095515.png]]
![[Pasted image 20240129095538.png]]

---

![[Pasted image 20240129095824.png]]

---

## LOG4J  CVE 2021-44228

https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2021-44228
![[Pasted image 20240129100230.png]]
<span style="background:#d4b106">Apache </span>Log4j2 2.0-beta9 through 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1) JNDI features used in configuration, log messages, and parameters do not protect against attacker controlled LDAP and other JNDI related endpoints. An attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP servers when message lookup substitution is enabled. From log4j 2.15.0, this behavior has been disabled by default. From version 2.16.0 (along with 2.12.2, 2.12.3, and 2.3.1), this functionality has been completely removed. Note that this vulnerability is specific to log4j-core and does not affect log4net, log4cxx, or other Apache Logging Services projects.

1. **JNDI (Java Naming and Directory Interface):**    
    - JNDI, Java uygulamalarının dizin ve isimlendirme hizmetlerine genel bir erişim sağlamak için kullanılan bir Java API (Application Programming Interface)’sidir. JNDI, Java uygulamalarının çeşitli kaynaklara, özellikle de dizin hizmetlerine, dosya sistemlerine ve veritabanlarına, standart bir arayüz üzerinden erişmelerini sağlar.
        
    - JNDI, Java uygulamalarının isimlendirilmiş nesnelere (objeler) erişimini sağlar. Bu, genellikle bir veritabanına, bir dizin hizmetine veya başka bir öğeye yönlendirme yapma yeteneği anlamına gelir. Bu, özellikle büyük ve dağınık sistemlerde kaynaklara dinamik bir şekilde erişim sağlamak için kullanılır.
        
2. **LDAP (Lightweight Directory Access Protocol):**
    
    - LDAP, dizin hizmetlerine (directory services) erişim sağlayan bir protokoldür. Dizin hizmetleri, genellikle kullanıcı hesapları, e-posta adresleri, bilgisayar kaynakları gibi yapısal verileri saklayan ve bu verilere hızlı bir şekilde erişim sağlayan bir tür veritabanı sistemidir.
        
    - LDAP, genellikle büyük ölçekli dizin hizmetleri için tasarlanmıştır. Kullanıcıların, uygulamaların ve diğer sistem kaynaklarının hızlı ve etkili bir şekilde yönetilebilmesini sağlar.
        
3. **CVE Açıklamasındaki Bağlam:**
    
    - CVE açıklamasında belirtilen güvenlik açığı, Apache Log4j2 kütüphanesinin belirli sürümlerinde JNDI ve LDAP ile ilgilidir. Bu açık, log mesajlarını kontrol eden veya log mesaj parametrelerini kontrol eden bir saldırganın, LDAP sunucularından yüklenen keyfi kodu yürütmesine olanak tanır. Bu, özellikle JNDI'yi kullanarak log mesajlarına gömülen ve kötü niyetli olarak kontrol edilen LDAP veya diğer JNDI bağlantı noktalarını içeren durumları ifade eder.
- ---


>[!warning] Bir Pentester olarak bir zaafiyeti exploit ettik ama bunun çalışma prensibini ve exploit ettiğimiz teknolojiyi eğer bilmiyor ve anlatamıyorsak bunun hiç bir anlamı ve değeri yok. O zaman sadece bir Scriptkiddy olursun.

---
#### Aynı CVE NIST sitesinde de var 
![[Pasted image 20240129101324.png]]

![[Pasted image 20240129101618.png]]
##### Burada bu zaafiyetin nasıl kullanıldığına dair siteler referanslar proof of cpncept'ler tool'lar bulunuyor.

![[Pasted image 20240129101747.png]]


![[Pasted image 20240129102138.png]]
"Known Affected Software Configurations" ifadesinde geçen "CPE," "Common Platform Enumeration" (Ortak Platform Numaralandırması) anlamına gelir. Bu durumda, "Known Affected Software Configurations" ifadesi, bir güvenlik duyurusunda veya zafiyet açıklamasında etkilenen yazılım konfigürasyonlarını belirtmek için kullanılan bir terimdir.

Güvenlik açıklamalarında, etkilenen yazılımın tanımlanması ve kataloglanması önemlidir. Bu nedenle, Common Platform Enumeration (CPE) standartı kullanılarak yazılımın öğe, sürüm ve üretici bilgileri belirtilir. Örneğin:

- **CPE: cpe:/a:example_vendor:example_software:1.0**
    - Bu örnekte, "example_vendor" tarafından geliştirilen "example_software" adlı yazılımın 1.0 sürümü etkilenen bir konfigürasyonu temsil eder.

Böylece, güvenlik duyurusunda "Known Affected Software Configurations" bölümünde belirtilen CPE'ler, güvenlik açığından etkilenebilecek yazılım ve sürümleri belirtir. Bu bilgiler, güvenlik profesyonellerinin ve sistem yöneticilerinin etkilenen sistemleri tespit etmelerine ve gerekli önlemleri almalarına yardımcı olur.

---

![[Pasted image 20240129102340.png]]
![[Pasted image 20240129102356.png]]
![[Pasted image 20240129102424.png]]
 
### Impact--->> Bu müşteriyi ilgilendiren en önemli bölümdür. Test yapılan sistemde zaafiyet olabilir fakat bunun etkisi veya hedef sisteme yapabileceği etkiyle ilgilenir müşteri.

![[Pasted image 20240129102956.png]]

---
## Zero Day Exploitation
##### Kimsenin CVE organisation'a raporlamadığı, kimsenin bilmediği zaafiyetlere denir.

---

![[Pasted image 20240129104834.png]]

---

![[Pasted image 20240129105023.png]]

---

## CASE STUDIES
![[Pasted image 20240129105308.png]]
#cve-case-study
#cve-2014-0160 #heartbleed
#cve-2017-0143 #eternalblue
#cve-2021-44228 #log4j


---
## Heartbleed
#cve-2014-0160 #heartbleed

1. **Heartbleed Nedir?**
    
    - Heartbleed, OpenSSL kütüphanesinin bir hatasıdır ve bu hata, bir saldırganın hedeflenen sunucudan hafıza belleği (memory) verilerini çalmasına olanak tanır. Bu veriler arasında şifreler, özel anahtarlar ve diğer hassas bilgiler bulunabilir.
2. **Hatayı Tetikleyen Mekanizma:**
    
    - SSL/TLS bağlantılarında kullanılan "heartbeat" mekanizması, bir tarafın diğerine belirli bir mesajı göndermesini ve bu mesajın bir yanıt almasını sağlar. Heartbleed hatası, bu mesajın uzunluğunun doğru bir şekilde kontrol edilmemesinden kaynaklanır.
3. **Zafiyetin Exploit Edilmesi:**
    
    - Bir saldırgan, etkilenen bir OpenSSL sürümünü kullanan bir hedef sunucuya özel bir "heartbeat" mesajı gönderir. Ancak, gönderilen mesajın uzunluğu hatalı bir şekilde kontrol edildiği için, saldırgan, normalde sunucunun cevaplaması gereken kadar veri almadan daha fazla hafıza belleği verisi alabilir.
4. **Elde Edilen Bilgiler:**
    
    - Bu hatanın istismar edilmesi, sunucunun belleğinden duyarlı bilgilerin çalınmasına neden olabilir. Örneğin, özel anahtarlar, kullanıcı şifreleri, oturum bilgileri gibi gizli verilere erişim sağlanabilir.
5. **Penetrasyon Testi Aşamasında:**
    
    - Bir pentester, hedef sistemlerdeki <span style="background:#d4b106">OpenSSL sürümlerini kontrol eder ve bu sürümlerde Heartbleed zafiyetinin bulunup bulunmadığını belirlemeye çalışır.</span>
        
    - Eğer hedef sistem etkilenen bir sürümü çalıştırıyorsa, pentester, bu zafiyeti istismar ederek sistemden duyarlı bilgilerin çalınmasını simüle edebilir. Bu, sistem sahiplerine ve yöneticilere gerçek dünya saldırı senaryoları hakkında bilgi verir.

1. **OpenSSL:**
    
    - <span style="background:#d4b106">OpenSSL, açık kaynaklı bir kriptografik kütüphanedir.</span> Bu kütüphane, çeşitli kriptografik algoritmaları, şifreleme yöntemlerini ve diğer güvenlik fonksiyonlarını içerir. OpenSSL, birçok uygulamada güvenli iletişim sağlamak için kullanılır.
2. **TLS (Transport Layer Security):**
    
    - <span style="background:#d4b106">TLS, veri iletimi sırasında gizlilik ve bütünlük sağlamak amacıyla kullanılan bir güvenlik protokolüdür.</span> TLS, internet üzerinden veri iletimi sırasında verilerin şifrelenmesi ve güvenli bir şekilde iletilmesi için tasarlanmıştır.
3. **Bağlantı:**
    
    - OpenSSL, TLS protokolünü uygulayan bir kütüphanedir. Yani, OpenSSL kullanılarak geliştirilen uygulamalar TLS protokolünü destekleyebilir. TLS, öncelikle güvenli veri iletimi için kullanılır ve genellikle web tarayıcıları ve sunucuları arasında, e-posta sunucularıyla istemcileri arasında, VPN bağlantıları gibi birçok farklı senaryoda kullanılır.
4. **Kullanım Senaryoları:**
    
    - OpenSSL, bir web sunucusu üzerinde TLS desteği eklemek veya bir uygulamayı güvenli bir şekilde bağlamak gibi çeşitli kullanım senaryolarında kullanılabilir. OpenSSL, TLS protokolünü uygulayarak güvenli, şifreli bir bağlantı kurulmasını sağlar.

---

## NIST
https://nvd.nist.gov/vuln/detail/cve-2014-0160

---
## Nmap  - Heartbleed
## Bu zaafiyet OpenSSL ve TLS ile ilgili olduğunu biliyoruz
### Bununla alakalı Nmap Script araştırmak için nmap.org'a bakabiliriz.

![[Pasted image 20240129112607.png]]

https://nmap.org/nsedoc/scripts/ssl-enum-ciphers.html
`nmap -sV --script ssl-enum-ciphers -p 443 <host>`


![[Pasted image 20240129115137.png]]
### Script çıktısında TLSv1 gördüğümüzde biz Heartbleed zaafiyeti olduğunu bileceğiz ve attack vektörünü buna göre belirleyebiliriz.

https://nmap.org/nsedoc/scripts/ssl-heartbleed.html
`nmap -p 443 --script ssl-heartbleed <target>`

![[Pasted image 20240129125247.png]]
##### Output'u incelediğinde sistemin Vulnureable olduğu ortaya çıkıyor. Nmap Script'i sayesinde...

---

## Exploitdb.com
![[Pasted image 20240129125601.png]]
![[Pasted image 20240129125645.png]]

---

https://www.exploit-db.com/exploits/32745
![[Pasted image 20240129131410.png]]


![[Pasted image 20240129131340.png]]
![[Pasted image 20240129131606.png]]
![[Pasted image 20240129131552.png]]
#### Şimdi buradaki mantıkta passwordu 12 karakterli olarak gonderdik. cevap da onaylama olarak geldi. ama biz bu parola 52 karakterlidir diye gonderdiğimizde hedef bilgisayardaki zaafiyet bize paroladan sonraki 40 karakter neyse onu bize sıralar.

### Sen bu geri donecek paket verileri Scapy veya python ile craft edersen o zaman bunu exploit edebilirsin ne istiyorsan.

![[Pasted image 20240129132055.png]]
64000 karaktere kadar tekrarlanabilir.
## Bu Buffer Over Read 'dir

Kodun ana mantığı şu adımları içermektedir:
1. Bir TCP bağlantısı oluşturulur ve belirtilen sunucu ve port üzerine bağlanılır.
2. Bir "Client Hello" mesajı sunucuya gönderilir. Bu, SSL/TLS el sıkışma işlemi için başlangıç mesajıdır.
3. Sunucudan gelen "Server Hello" mesajı beklenir ve el sıkışma işlemi tamamlanır.
4. Heartbleed zafiyetini test etmek için bir "Heartbeat Request" (kalp atışı isteği) mesajı gönderilir.
5. Sunucudan gelen yanıt incelenir ve zafiyetin varlığına dair belirtiler aranır.

`hit_hb` fonksiyonu, sunucudan gelen yanıtı işleyip, zafiyetin varlığını değerlendirir. Eğer sunucu, uygun bir şekilde yanıt verirse ve belirli bir durumu karşılarsa, bu zafiyetin bulunduğunu belirtir.


### Bu bir exploit değil sadece vuln var mı yok mu bunun tespiti için kullamnılan python kodudur.

![[Pasted image 20240129130939.png]]

>[!info] Hedef eğer compromised edilmişse ve hedef eğer vuln bir Open SSL kullanıyorsa bu hedeften bir çok bilgi alınabilir.

----

## Çalışılabilecek HACKTHEBOX MAchine
### https://app.hackthebox.com/machines/Valentine/reviews 

---

# Heartbleed Tespiti
##### Nmap taraması yaptıktan ve portları tek tek versiyon taraması dahil yaptıktan sonra karşımıza port 443 de vea başka değiştirilmiş portlarda OPENSSL v1... çıkarsa
### nmap --->>> ssl script
### nessus-->>> vuln scan
### metasploitable ---> msfconsole 
![[Pasted image 20240129131301.png]]


---
## EternalBlue
#eternalblue 
#ms17-010
#cve-2017-0143 
![[Pasted image 20240129132720.png]]
https://www.exploit-db.com/exploits/43970
https://www.exploit-db.com/exploits/41891
![[Pasted image 20240129132903.png]]
https://www.exploit-db.com/exploits/41891

### Bu vuln Wannacry Ransomware attack'ın bir parçası olduğu için çok bilindiktir.
1. **EternalBlue Zafiyeti:** Saldırganlar, EternalBlue zafiyetini kullanarak hedef sistemlere sızabilir ve bu sayede uzaktan kod yürütme yeteneği elde edebilirler.
    
2. **WannaCry Fidye Yazılımı:** Saldırganlar, EternalBlue zafiyetini kullanarak hedef sistemlere sızdıktan sonra, WannaCry fidye yazılımını yayarak bilgisayarları kilitleyip kullanıcılardan fidye talep edebilirler. WannaCry, siber suçluların kurbanlardan Bitcoin cinsinden ödeme yapmalarını istediği bir fidye yazılımıydı.
    
3. **Yayılma Mekanizması:** WannaCry, bir kez bir sistemde başarıyla çalıştığında, ağdaki diğer bilgisayarlara kendini otomatik olarak yayma yeteneğine sahipti. Bu, bir bilgisayardaki zafiyetin kullanılmasıyla süratle yayılabilmesine olanak tanıyan bir özelliktir.

WannaCry, bir <span style="background:#d4b106">APT ADVANCED PERSISTED THREAT</span> tarafından geliştirilmiş ve dağıtılmış bir fidye yazılımıdır. WannaCry, EternalBlue zaafiyetini kullanarak hedef bilgisayarları ele geçirdi ve ardından dosyalarını şifreledi. WannaCry, 2017 yılında dünya çapında büyük bir saldırıya neden oldu ve yaklaşık 200 ülkede 200.000'den fazla bilgisayarı etkiledi.

---
## Nmap Eternalblue
#ms17-010 
https://nmap.org/nsedoc/scripts/smb-vuln-ms17-010.html
![[Pasted image 20240129134324.png]]
### -`nmap -p445 --script smb-vuln-ms17-010 <target>`
    
### -`nmap -p445 --script vuln <target>`




---
## Msf ---- EternalBlue
```
#### msf6> use auxiliary/scanner/smb/smb_ms17_010 

```
![[Pasted image 20240129132903.png]]


---

>[!warning] 1. EternalBlue SMB'yi kapatabilir bu yüzden dikkatli olunması gerekir exploit edilirken.
>2. Nmap eternalblue script safe scriptMi kontrol edilmelidir bu SMB'yi kapatma durumu sözkonusu olduğu için
>3. SMBv1 çalışıyorsa hedef sistemde veya Eternalblue zafiyeti olan OS ise win7 ServicePack 7 gibi attack vektörünü buna göre ayarlamak gerekir.
>4. ![[Pasted image 20240129140005.png]]
>5. Metasploit kullarak exploit edeceksek yukarıdaki malicious payload gönderilir. 
>6. Bu payload da smb içinde buffer over flow zaafiyetinden yaralanır. 
>7. Bunun sayesinden remote code execution yapabilir ve hedef makineden bize reverse shell alması sağlanabilir.
>8. ![[Pasted image 20240129140307.png]]
>9. Bu attack gerçekleştikten sonra içeri konulan bir ransomware önce ilk compromise olan sistemi daha sonra buna bağlı olup aynı eternalblue zaafiyeti olan diğer bütün sistemleri bulur ve hepsini enfekte eder.


###### ICS, Endüstriyel Kontrol Sistemleri anlamına gelir. SCADA ise, Sanayi Dağıtım Kontrolü anlamına gelir. Bu sistemler, enerji santralleri, petrol ve gaz tesisleri, su ve kanalizasyon sistemleri, üretim tesisleri ve diğer kritik altyapıları kontrol etmek için kullanılır. ICS ve SCADA sistemleri genellikle, Windows işletim sistemi çalıştıran bilgisayarlar tarafından kontrol edilir. Bu sistemler, genellikle kritik altyapıları kontrol ettikleri için, güvenlik açısından hassastır.
##### EternalBlue zaafiyeti, 2017 yılında gerçekleşen WannaCry fidye yazılımı saldırısı da dahil olmak üzere birçok büyük saldırıda kullanılmıştır. WannaCry saldırısı, ICS ve SCADA sistemlerini de etkiledi ve bu sistemlere milyarlarca dolarlık hasara neden oldu.

---

## Log4J
#log4j 
#cve-2021-44228 

![[Pasted image 20240129140850.png]]
https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2021-44228
https://nvd.nist.gov/vuln/detail/CVE-2021-44228

![[Pasted image 20240129141107.png]]
![[Pasted image 20240129141154.png]]


---
Log4j, Apache Software Foundation tarafından geliştirilen ve Java uygulamalarında kullanılan bir günlük kaydı kütüphanesidir. Log4j, uygulama geliştiricilerin hata mesajları, istatistikler ve diğer bilgileri günlük dosyalarına kaydetmesine olanak tanır.

CVE-2021-44228, Log4j kütüphanesinde bulunan bir güvenlik zaafiyetidir. Bu zafiyet, saldırganların uzaktan bir bilgisayarı ele geçirmesine olanak tanır.

---
Basit bir komut çalıştırarak bu exploit edilebilir.
Log4j deki log mesajlarını kontrol edebilen komut yürütebilir.
Java sistemde ne zaman kullanılsa ben de sisteme erişim sağlayabilirim.
auth olmadan sisteme girebilirim
bir LDAP Server set up yapabilirim. Java ne zaman kullanılırsa sisteme erişim sağlanır.


CVE-2021-44228 zafiyetinin anatomisi şu adımları içerir:

1. **Log4j Kütüphanesindeki JNDI Lookup Özelliği:**
    
    - Log4j'nin belirli sürümlerinde, Java Naming and Directory Interface (JNDI) adı verilen bir özellik bulunmaktadır. Bu özellik, uygulamanın dışındaki kaynaklara bağlanmak için kullanılır.
2. **JNDI Lookup Saldırısı:**
    
    - Saldırgan, Log4j'nin JNDI özelliğini kullanarak uzaktaki bir JNDI sunucusuna bağlanabilecek bir payload (yük) oluşturabilir.
    - Bu payload, saldırganın kontrolündeki bir JNDI sunucusundan isteğe bağlı Java nesnelerini çağırmak için kullanılabilir.
3. **Uzaktan Kod Yürütme:**
    
    - Saldırgan, Log4j kütüphanesine bu kötü niyetli payload'ı göndererek uzaktan kod yürütme yeteneği elde edebilir.
    - Saldırgan, bu zafiyeti kullanarak hedef sistemde istediği komutları çalıştırabilir ve sistemi ele geçirebilir.
4. **Etkilenen Sürümler ve Güncellemeler:**
    
    - Bu zafiyet, Log4j'nin belirli sürümlerini etkiler. Log4j projesi, bu güvenlik açığını düzeltmek için hızlı bir şekilde güncellemeler yayınlamıştır. Kullanıcılar, etkilenen sürümlerden güncellenmiş sürümlere geçmelidirler.
5. **Yayılma ve Saldırı Senaryoları:**
    
    - Zafiyetin yayılma potansiyeli, etkilenen Log4j kullanılan birçok Java tabanlı uygulama ve sunucuyu etkileyebilir. Saldırganlar, zafiyeti kullanarak geniş çaplı saldırılar başlatabilir ve özellikle hedeflenen sistemlerde ciddi güvenlik sorunlarına neden olabilir.

----
### JAVA'nın Çok fazla oyunda, application'da kullanılması bu saldırının etkisini arttırmıştır. 

---


#### Bu daha yeni bir zaafiyet olduğu için NMAP script'leri yazılmaya devam ediyor.
##### https://github.com/giterlizzi/nmap-log4shell
### Buradan nmap nse script aldık ve bizim kendi /usr/share/nmap/scripts klasöümüzün içine kopyaladık yazılmış olan script'i

```
nmap --script log4shell.nse --script-args log4shell.callback-server=172.17.42.1:1389 -p 8080 172.17.42.2
```
---
**Here's a breakdown of what the code does:**

**Purpose:**

- Scans a target system (172.17.42.2) for the Log4Shell vulnerability (CVE-2021-44228).

**Tools:**

- Nmap: Network scanning tool used for vulnerability discovery.
- log4shell.nse: A Nmap script specifically designed to detect Log4Shell.

**Command Breakdown:**

- `nmap`: Invokes the Nmap program.
- `--script log4shell.nse`: Specifies the log4shell.nse script to be used for scanning.
- `--script-args log4shell.callback-server=172.17.42.1:1389`: Provides a callback server and port for confirming successful exploitation.
    - `log4shell.callback-server`: Argument for the script.
    - `172.17.42.1:1389`: Callback server's IP address and port.
- `-p 8080`: Targets port 8080 for scanning.
- `172.17.42.2`: Specifies the IP address of the target system to be scanned.

**Process:**

1. **Connects to target:** Nmap establishes a connection to the target system (172.17.42.2) on port 8080.
2. **Sends probes:** The log4shell.nse script sends crafted probes to the target, attempting to trigger the Log4Shell vulnerability.
3. **Awaits callback:** If exploitation is successful, the target system sends a callback to the designated server (172.17.42.1) on port 1389, confirming vulnerability.
4. **Reports results:** Nmap displays scan results, indicating whether the target is vulnerable to Log4Shell.

**Key Points:**

- **Non-intrusive:** The scan doesn't harm the target system.
- **Specific to Log4Shell:** Focuses solely on detecting this vulnerability.
- **Requires callback server:** Vulnerability confirmation relies on a callback being received.
- **Can be used with other Nmap scripts:** Extend functionality for broader vulnerability scanning.
![[Pasted image 20240129151221.png]]

----
## Attack Anatomy
![[Pasted image 20240129151323.png]]

### %84 of JAVA log.lama için Log4J kullanıyor.

![[Pasted image 20240129151628.png]]
### PORT 1389 bizim LDAP server'ımızdir


### https://tryhackme.com/room/solar
https://github.com/YfryTchsGD/Log4jAttackSurface


![[Pasted image 20240129154646.png]]
![[Pasted image 20240129154956.png]]

---

## NESSUS - LAB 1
#nessus 
Nessus, bir ağdaki veya bir bilgisayardaki güvenlik açıklarını tespit etmek için kullanılır. Nessus, bir bilgisayarın veya ağın işletim sistemini, yazılımını ve açıklarını analiz ederek çalışır. Nessus, güvenlik açığı tespiti, uyumluluk denetimi ve sızma testi gibi çeşitli amaçlar için kullanılabilir.

Nessus'un başlıca özellikleri şunlardır:

- Çok çeşitli güvenlik açıklarını tespit edebilir.
- Ağdaki veya bilgisayardaki tüm cihazları tarayabilir.
- Tarama sonuçlarının ayrıntılı raporlarını oluşturabilir.
- Otomatik tarama ve raporlama özelliklerine sahiptir.

![[Pasted image 20240130092539.png]]
![[Pasted image 20240130092601.png]]
![[Pasted image 20240130092719.png]]
### CGI Abuses : Nessus CGI Abuses" ifadesi, Nessus adlı bir güvenlik tarayıcı tarafından algılanan ve raporlanan CGI (Common Gateway Interface) ile ilgili güvenlik istismarlarını ifade eder.

---
![[Pasted image 20240130092915.png]]


### Nessus yaptığı vuln taraması sonucu SQLi tespit etti . Bunu da phpMyAdmin sürümünün eski olması sayesinde buldu.

![[Pasted image 20240130093419.png]]
##### Şimdi bize output olarak 

##### http://demo.ine.local/phpmyadmin --> bu sayfadan bu tespit edilen vuln'a bakabilirsin diye sonuç veriyor.

---
![[Pasted image 20240130093607.png]]
#### Bu sürüm özelliğinden dolayı bize hiçbir yere login işlemi yapmadık ama bize direk access verdi.

![[Pasted image 20240130093820.png]]
##### Bu sürüm güncellenmediği için direk 
##### http://demo.ine.local/phpmyadmin 
##### directory'i bulmuş olman yeterli. Normal internet kullanırken gözükmez ama dirb, nessus bize bunu çok kolay bulur.

---

## 1. Vulnerability Research Lab

![[Pasted image 20240130095614.png]]
![[Pasted image 20240130095643.png]]
![[Pasted image 20240130095718.png]]
![[Pasted image 20240130095734.png]]
### Stack-Based Buffer Overflow Nedir?

Stack-based buffer overflow, bir programın bellek yönetimindeki bir hatadan kaynaklanan bir güvenlik açığı türüdür. Bu tür bir güvenlik açığı, genellikle C veya C++ gibi düşük seviyeli dillerle yazılmış programlarda ortaya çıkar.

Temel olarak, bir programın çalışma zamanında kullanıcı tarafından sağlanan giriş verisi, programın hafızasında ayrılmış olan bir bellek alanına yazılırken kontrolsüz bir şekilde taşma (overflow) gerçekleşirse, bu duruma "buffer overflow" denir. "Stack-based" ifadesi, bu taşmanın genellikle programın yığıt (stack) bölgesindeki bir bellek alanında meydana geldiğini ifade eder.

Bu tür bir güvenlik açığı istismar edildiğinde, saldırganlar bu taşma nedeniyle hafıza bölgesinin kontrolünü ele geçirebilir ve programın normal çalışma akışını değiştirebilir. Bu, kötü amaçlı kod enjeksiyonu, yetki yükseltme veya başka zararlı faaliyetleri gerçekleştirmek için kullanılabilir.


---

![[Pasted image 20240130101826.png]]
![[Pasted image 20240130101930.png]]
![[Pasted image 20240130102037.png]]


---
## Manuel Exploit
https://www.exploit-db.com/exploits/4784
![[Pasted image 20240130102214.png]]
![[Pasted image 20240130102227.png]]
### Usage
![[Pasted image 20240130102345.png]]
![[Pasted image 20240130102447.png]]
Bu exploit'i kullanmak için, aşağıdaki adımları izleyin:
1. Metasploit'i başlatın.
2. **exploit/windows/remote/win32_bind** exploit'ini seçin.
3. **LPORT** parametresini, hedef makinede çalıştırmak istediğiniz port numarasıyla değiştirin. Bu örnekte, **LPORT=4444** olarak ayarlanmıştır.
4. **Encoder** parametresini, exploit'i kodlamak için kullanmak istediğiniz kodlayıcıyla değiştirin. Bu örnekte, **Encoder=PexAlphaNum** olarak ayarlanmıştır.
5. **Run** düğmesine tıklayın.


---

## Metasploit BadBlue
![[Pasted image 20240130105509.png]]

##### msf6>use  exploit/windows/http/badblue_ext_overflow 
![[Pasted image 20240130105549.png]]

### Burada dikkat edilmesi gereken PAYLOAD belirleyeceğiz. 
![[Pasted image 20240130105856.png]]
## msf6 exploit(windows/http/badblue_ext_overflow) > info

>[!warning] Herhangi bir Metasploit modulu için bilgi almak için msf6> info komutu  ve -ya msf6> info -d komutu ile herşeyi alabilirsin. 
>Ayrıca yukarrıdaki msf modulunde PAYLOAD seçmen gerekiyor. Aynı MULTI HANDLERDAKİ GİBİ

## msf6 > set PAYLOAD windows/meterprete/reverse_tcp

### Aklına gelmediyse TAB
![[Pasted image 20240130110428.png]]

msf6>set PAYLOAD windows/meterpreter/reverse_tcp


---

![[Pasted image 20240130110537.png]]

![[Pasted image 20240130110634.png]]

---
# Auditing Fundamentals

## Regulations
#cyber-security-regulations
![[Pasted image 20240130112647.png]]
### Bu regulationlara şirketler uymaz ise dava edilebilirler.

![[Pasted image 20240130112823.png]]

![[Pasted image 20240130112949.png]]
![[Pasted image 20240130113109.png]]
### Avrupada Çalışmak isteyen Siber güvenlik uzmanu GDPR bu regulation'u bilmesi gerekir.
1. **Makul Güvenlik Önlemleri Almak:** GDPR, kişisel verilere ilişkin işlemlerde yer alan veri sorumlularından, "makul güvenlik önlemleri" almalarını talep eder. Bu önlemler arasında siber saldırılara karşı korunma amacıyla güvenlik testleri yapmak da yer alabilir.
    
2. **Risk Değerlendirmesi ve Koruma:** GDPR, veri sorumlularının düzenli olarak risk değerlendirmeleri yapmalarını ve gerekirse güvenlik önlemlerini güncellemelerini bekler. Bu çerçevede, penetrasyon testleri risk değerlendirmelerinin bir parçası olarak kullanılabilir.
    
3. **Veri İhlallerinin Bildirilmesi:** GDPR'a göre, bir veri ihlali durumunda veri sorumluları, bu ihlali derhal ve 72 saat içinde ilgili denetim otoritesine bildirmekle yükümlüdür. Güvenlik testleri, veri ihlali olasılıklarını değerlendirmek ve bu tür durumlara hazırlıklı olmak için önemli bir araç olabilir.
    
4. **Gizlilik ve Güvenlik Standartlarına Uyum:** GDPR, kişisel verilerin işlenmesinde gizlilik ve güvenlik standartlarına uyumun sağlanmasını ister. Penetrasyon testleri, bu standartlara uyumun değerlendirilmesinde yardımcı olabilir.
    

Ancak, GDPR'da açık bir şekilde "penetrasyon testi yapılmalıdır" gibi spesifik bir ifade yoktur. Bunun yerine, genel olarak güvenlik önlemleri, risk değerlendirmeleri ve uygun güvenlik tedbirleri alınması gerektiği vurgulanmaktadır.

---

![[Pasted image 20240130113305.png]]

![[Pasted image 20240130113629.png]]

---
# FRAMEWORKs

![[Pasted image 20240130113852.png]]

![[Pasted image 20240130113915.png]]

1. ISO: International Organization for Standardization
2. IEC: International Electrotechnical Commission

ISO/IEC 27000, bilgi güvenliği yönetim sistemleri için standartları belirleyen bir dizi uluslararası standart serisidir. Bu standartlar, organizasyonların bilgi güvenliğini etkin bir şekilde yönetmelerine ve korumalarına yardımcı olmayı amaçlar. ISO/IEC 27000 serisi, dünya genelinde birçok endüstri ve sektörde kullanılmaktadır.
En öne çıkan standartlardan biri olan ISO/IEC 27001, bilgi güvenliği yönetim sistemlerinin gereksinimlerini belirler ve organizasyonların bu sistemleri kurmalarını ve sürdürmelerini sağlar. Diğer standartlar, bu temel standart olan ISO/IEC 27001'i destekleyerek belirli konularda daha detaylı bilgiler sağlar.

![[Pasted image 20240130114315.png]]

---

![[Pasted image 20240130114339.png]]
![[Pasted image 20240130114413.png]]
![[Pasted image 20240130114516.png]]
![[Pasted image 20240130114629.png]]
![[Pasted image 20240130115029.png]]


---
>[!warning] Hazırlayacağın PENTEST raporuna bu Regulation'lardaki maddeleri uygulayıp uygulamadıklarıyla alakalı bilgi vermelisin ve bunları uygulamazlarsa ise neler olabileceğine dair kısa notlar düşmelisin.

---
---
---

## Auditing
	![[Pasted image 20240130232244.png]]

![[Pasted image 20240130232404.png]]
![[Pasted image 20240130232437.png]]
![[Pasted image 20240130232631.png]]
## JOPLIN
## ONENOTE
## SUBLIMETEXT

---
![[Pasted image 20240130232808.png]]
### Clinet sana pentest için para ödemiyor | Sana iyi anlaşılır bir REPORT için para ödüyor.
![[Pasted image 20240130232824.png]]

## Acumen 
{i} çabuk kavrama yeteneği, keskin zek­â
{i} sezgi
Benim için, onun hiçbir siyasi sezgisinin olmadığı açıktır. 
It is obvious to me that he has no political acumen at all.
{i} zekâ

---

## SCAP Scan and Stigviewer
#cmmc 
#scap
#scap-scan& #stigviewer
### Security Content Automation Protocol
### Security Technical Implementation Guides
### DISA --> DEFENSE INFORMATION SYSTEM AGENCY

### NIST 800-53
![[Pasted image 20240130234030.png]]

CMMC, "Cybersecurity Maturity Model Certification"ın kısaltmasıdır. CMMC, ABD Savunma Sanayi Tabanı'ndaki (Defense Industrial Base - DIB) şirketlerin siber güvenlik standartlarını değerlendirmek ve belgelemek amacıyla oluşturulmuş bir siber güvenlik sertifikasyon modelidir. Savunma Sanayi Tabanı, Savunma Bakanlığı (Department of Defense - DoD) ile iş yapan ve savunma projelerine katılan şirketleri içerir.

CMMC, savunma sanayi yüklenicilerinin siber güvenlik uygunluk düzeyini değerlendirmek ve belirlemek için beş farklı maturite seviyesini tanımlar. Bu seviyeler şunlardır:

1. **Seviye 1 - Temel Uyum (Basic Cyber Hygiene):** En düşük seviye, temel siber güvenlik uygulamalarını içerir.
    
2. **Seviye 2 - Ortak Uyum (Intermediate Cyber Hygiene):** Orta düzeyde siber güvenlik uygulamalarını içerir.
    
3. **Seviye 3 - İleri Uyum (Good Cyber Hygiene):** Daha gelişmiş siber güvenlik uygulamalarını ve yönetim kontrolünü içerir.
    
4. **Seviye 4 - Yüksek Uyum (Proactive):** Proaktif siber güvenlik uygulamalarını içerir.
    
5. **Seviye 5 - İleri Yüksek Uyum (Advanced/Progressive):** En üst düzeyde siber güvenlik uygulamalarını ve optimize edilmiş yönetim kontrolünü içerir.
    

CMMC, şirketlerin hangi seviyede bir siber güvenlik uyumluluğuna sahip olduklarını belirlemelerini sağlar. DoD sözleşmelerine katılan savunma sanayi yüklenicilerinin bu sertifikasyonları alması ve belirli bir projede hangi düzeyde uyumlu olmaları gerektiğini belirtmeleri istenir. Bu, savunma sanayiindeki siber güvenlik standartlarını yükseltmeyi ve daha güvenli bir ortam sağlamayı amaçlamaktadır.

SCAP (Security Content Automation Protocol), bilgisayar sistemlerinin güvenlik uyumluluğunu değerlendirmek ve düzeltme için standart bir protokoldür. Bu protokolü uygulamak için çeşitli araçlar mevcuttur. SCAP araçları, bir sistemdeki güvenlik ayarlarını değerlendirmek, zayıflıkları tespit etmek ve uygun düzeltmeleri uygulamak amacıyla kullanılabilir.

Kali Linux'ta SCAP araçlarını yüklemek için genellikle paket yöneticisi olan `apt` kullanılır. İlgili SCAP araçlarından biri olan OpenSCAP'ı Kali Linux'a yüklemek için aşağıdaki adımları izleyebilirsiniz:

1. Terminali açın.

2. Aşağıdaki komutu kullanarak OpenSCAP'ı yükleyin:

    ```bash
    sudo apt update
    sudo apt install -y openscap-utils
    ```

    Bu komutlar, paket listesini günceller ve OpenSCAP araçlarını yükler.

3. İşlem tamamlandıktan sonra, OpenSCAP araçlarını kullanmaya başlayabilirsiniz. Örnek olarak, SCAP içeriğini tarayarak sistem uyumluluğunu değerlendirmek için `oscap` komutunu kullanabilirsiniz.


---

## CMMC MODEL
![[Pasted image 20240130233941.png]]


![[Pasted image 20240130235400.png]]

![[Pasted image 20240131105016.png]]
https://www.youtube.com/watch?v=asutYWy57Yc&list=PLTdjM-rC8LY63orIDAoUxF-7lqudrh9aB&index=1

---



